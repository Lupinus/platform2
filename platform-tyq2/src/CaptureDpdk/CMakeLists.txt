SET(SRC_LIST dpdk.c choice.c hash.c shmdata.c json.c structure.c cJSON.c cmdline.c config.c iofwd.c macfwd.c macswap.c flowgen.c rxonly.c txonly.c csumonly.c icmpecho.c tools.c)
add_library(CaptureDpdk SHARED ${SRC_LIST})
target_include_directories(CaptureDpdk PUBLIC ${INCLUDE_PATH}/CaptureDpdk ${DPDK_INCLUDE_PATH})
target_compile_options(CaptureDpdk PUBLIC -m64 -pthread -fPIC  -march=native -include ${DPDK_INCLUDE_PATH}/rte_config.h -DRTE_MACHINE_CPUFLAG_SSE -DRTE_MACHINE_CPUFLAG_SSE2 -DRTE_MACHINE_CPUFLAG_SSE3 -DRTE_MACHINE_CPUFLAG_SSSE3 -DRTE_MACHINE_CPUFLAG_SSE4_1 -DRTE_MACHINE_CPUFLAG_SSE4_2 -DRTE_MACHINE_CPUFLAG_AES -DRTE_MACHINE_CPUFLAG_PCLMULQDQ -DRTE_MACHINE_CPUFLAG_AVX -DRTE_MACHINE_CPUFLAG_RDRAND -DRTE_MACHINE_CPUFLAG_FSGSBASE -DRTE_MACHINE_CPUFLAG_F16C -DRTE_MACHINE_CPUFLAG_AVX2 -DRTE_MACHINE_CPUFLAG_SSE -DRTE_MACHINE_CPUFLAG_SSE2 -DRTE_MACHINE_CPUFLAG_SSE3 -DRTE_MACHINE_CPUFLAG_SSSE3 -DRTE_MACHINE_CPUFLAG_SSE4_1 -DRTE_MACHINE_CPUFLAG_SSE4_2 -DRTE_MACHINE_CPUFLAG_AES -DRTE_MACHINE_CPUFLAG_PCLMULQDQ -DRTE_MACHINE_CPUFLAG_AVX -DRTE_MACHINE_CPUFLAG_RDRAND -DRTE_MACHINE_CPUFLAG_FSGSBASE -DRTE_MACHINE_CPUFLAG_F16C -DRTE_MACHINE_CPUFLAG_AVX2 -W -Wall -Wstrict-prototypes -Wmissing-prototypes -Wmissing-declarations -Wold-style-definition -Wpointer-arith -Wcast-align -Wnested-externs -Wcast-qual -Wformat-nonliteral -Wformat-security -Wundef -Wwrite-strings -fPIC #[[-O3]] -g -Wall -Wextra -Wno-unused-parameter)
target_link_directories(CaptureDpdk PUBLIC ${DPDK_LIB_PATH})
target_link_libraries(CaptureDpdk PUBLIC dpdk rt m gcc_s dl rte_pmd_e1000 rte_pmd_i40e rte_pmd_ixgbe)
target_link_options(CaptureDpdk PUBLIC -export-dynamic -g -shared)